<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="favicon.png">
    <title>About & FAQ | DarkLight</title>
    <meta name="description" content="About DarkLight, FAQ, and team information.">
    <link rel="stylesheet" href="https://use.typekit.net/efe5rwd.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://unpkg.com/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <style>
        html, body {
            background-color: black !important;
            color: #7B7B7B;
            scroll-behavior: smooth;
            height: 100% !important;
            min-height: 100vh !important;
            overflow-x: hidden !important;
        }

        .logo {
            width: 100%;
            padding: 15px 0 0 0;
            text-align: center;
        }
        .about-merged-layout {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            width: 100%;
            height: auto;
            min-height: 100vh;
            overflow: visible;
            padding: 24px;
        }
        .about-merged-nav {
            width: 50%;
            min-width: 0;
            max-width: none;
            background: none;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            padding: 40px 0 0 0;
            position: sticky;
            top: 25rem;
            z-index: 10;
            height: fit-content;
            min-height: 0;
        }
        .about-merged-nav a {
            color: #D3D3D3;
            text-decoration: none;
            font-size: 18px;
            font-weight: 400;
            line-height: 23px;
            letter-spacing: 2px;
            margin-bottom: 30px;
            background: none;
            border: none;
            padding: 0;
            text-align: left;
            transition: color 0.2s;
            display: block;
        }
        .about-merged-nav a.active, .about-merged-nav a:hover {
            color: #D3D3D3;
           
        }
        .about-merged-content {
            width: 50%;
            padding: 40px 0 40px 40px;
            max-width: none;
            height: auto;
            min-height: 0;
            overflow: visible;
        }
        .about-merged-content p, .about-merged-nav a, .faq-answer, .faq-question {
            font-size: 18px;
            font-weight: 400;
            line-height: 23px;
            letter-spacing: 2px;
            text-align: left;
            margin-bottom: 18px;
            background: none;
            border: none;
            padding: 0;
        }
        .faq-list {
            margin-top: 3rem;
        }
        .faq-item {
            margin-bottom: 3rem;
            border-bottom: .5px solid #7B7B7B;
            padding-bottom: 3rem;
        }
        .faq-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        .faq-question {
            all: unset;
            color: #7B7B7B;
            font-size: 18px !important;
            font-weight: 400;
            line-height: 23px;
            letter-spacing: 2px;
            text-align: left;
            margin-bottom: 0.2rem;
            display: block;
        }
        .faq-question:hover, .faq-question:focus, .faq-question:active {
            color: #D3D3D3;
    
            background: none;
            border: none;
            text-decoration: none;
            outline: none;
            cursor: default;
            font-size: 18px !important;
            font-weight: 400;
            line-height: 23px;
            letter-spacing: 2px;
            transform: none !important;
        }
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            margin-bottom: 0.5rem;
            transition: max-height 0.8s ease-in-out, margin-bottom 0.8s ease-in-out;
        }
        .faq-item.open .faq-answer {
            max-height: 200px;
            margin-bottom: 0.5rem;
        }
        @media (max-width: 900px) {
            .about-merged-layout {
                flex-direction: column;
                height: auto;
                min-height: 0;
            }
            .about-merged-nav, .about-merged-content {
                width: 100%;
                max-width: 100vw;
                padding: 20px 0 0 0;
                height: auto;
                min-height: 0;
            }
            .about-merged-content {
                padding: 20px 0 20px 0;
            }
        }
        .custom-nav a,
        .custom-nav a:visited,
        .custom-nav a:active,
        .custom-nav a:focus,
        .custom-nav a:hover {
            all: unset; /* Remove all inherited styles */
            display: block;
            font-size: 18px;
    font-weight: 400;
    line-height: 23px;
    letter-spacing: 2px;
            color: #7B7B7B;
            cursor: pointer;
            margin-bottom: 0;
            padding: 0;
            text-align: left;
        }
        .about-merged-content section {
            margin-bottom: 20vh;
            padding-top: 48px;
        }
        .about-merged-content section:last-child {
            margin-bottom: 0;
        }
        .section-title {
            /* color: #7B7B7B; */
            color: #D3D3D3;
            font-size: 18px;
            margin-bottom: 18px;
            letter-spacing: 2px;
            text-align: left;
        }
        .content-section {
            margin-bottom: 2rem;
        }
        .content-section h1, .content-section h2, .content-section h3, .content-section h4, .content-section h5, .content-section h6 {
            color: #D3D3D3;
            font-size: 18px;
            margin-bottom: 18px;
            letter-spacing: 2px;
            text-align: left;
        }
        .content-section p {
            margin-bottom: 18px;
        }
        .content-section a {
            color: inherit;
            text-decoration: underline;
            text-underline-offset: 5px;
        }
        .content-section strong, .content-section b, .content-section span {
            font-weight: 400 !important;
        }
        .about-us-item strong, .about-us-item b, .about-us-item span {
            font-weight: 400 !important;
        }
        .faq-answer strong, .faq-answer b, .faq-answer span {
            font-weight: 400 !important;
        }
        .about-us-item {
            margin-bottom: 2rem;
        }
        .about-us-item h1, .about-us-item h2, .about-us-item h3, .about-us-item h4, .about-us-item h5, .about-us-item h6 {
            color: #D3D3D3;
            font-size: 18px;
            margin-bottom: 18px;
            letter-spacing: 2px;
            text-align: left;
        }
    </style>
</head>
<body class="about-page">
    <div class="logo">
        <a href="index.html">
            <img src="images/motif.svg" alt="DARKLIGHT immersive light and sound exhibition in Auckland" width="20%">
        </a>
    </div>
    <div class="about-merged-layout">
        <nav class="about-merged-nav custom-nav" id="navigation">
            <!-- Navigation will be loaded dynamically -->
        </nav>
        <main class="about-merged-content" id="content">
            <!-- Content will be loaded dynamically -->
            <div class="loading">Loading content...</div>
        </main>
    </div>

    <script>
    // Load about page content
    async function loadAboutContent() {
        try {
            const response = await fetch('/content/about.md');
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const text = await response.text();
            console.log('Raw about content:', text);
            
            // Split the content at the frontmatter markers
            const parts = text.split('---');
            if (parts.length >= 2) {
                const yamlContent = parts[1];
                console.log('YAML content:', yamlContent);
                
                const data = jsyaml.load(yamlContent);
                console.log('Parsed data:', data);
                
                // Render the about page content
                renderAboutPage(data);
            }
        } catch (err) {
            console.error('Failed to load about content:', err);
            document.getElementById('content').innerHTML = `
                <div class="section-title">
                    <p>About & FAQ</p>
                </div>
                <div class="content-section">
                    <p>Failed to load content. Please refresh the page.</p>
                </div>
            `;
        }
    }

    function renderAboutPage(data) {
        // Render navigation (only visible items)
        const navigation = document.getElementById('navigation');
        if (data.navigation && data.navigation.length > 0) {
            const visibleNav = data.navigation.filter(nav => nav.visible !== false);
            navigation.innerHTML = visibleNav.map(nav => `
                <a href="#${nav.section_id}" id="nav-${nav.section_id.replace('about-', '')}">
                    <span class="nav-num">${nav.number}</span> 
                    <span class="nav-label">${nav.label}</span>
                </a>
            `).join('');
        }

        // Render content sections (only visible items)
        const content = document.getElementById('content');
        if (data.sections && data.sections.length > 0) {
            const visibleSections = data.sections.filter(section => section.visible !== false);
            content.innerHTML = visibleSections.map(section => {
                let sectionContent = '';
                
                if (section.content_type === 'text') {
                    // Convert markdown to HTML (simple conversion for basic formatting)
                    const htmlContent = convertMarkdownToHtml(section.content);
                    sectionContent = `<div class="content-section">${htmlContent}</div>`;
                } else if (section.content_type === 'faq') {
                    sectionContent = renderFAQSection(section);
                } else if (section.content_type === 'about_us') {
                    sectionContent = renderAboutUsSection(section);
                }
                
                return `
                    <section id="${section.section_id}">
                        <div class="section-title">${section.title}</div>
                        ${sectionContent}
                    </section>
                `;
            }).join('');
        }

        // Initialize FAQ functionality
        initializeFAQ();
        
        // Initialize navigation active state
        initializeNavigation();
    }

    function convertMarkdownToHtml(markdown) {
        if (!markdown) return '';
        
        return markdown
            .replace(/\*\*(.*?)\*\*/g, '<span>$1</span>')
            .replace(/\*(.*?)\*/g, '<span>$1</span>')
            .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>')
            .replace(/\n\n/g, '</p><p>')
            .replace(/^/, '<p>')
            .replace(/$/, '</p>');
    }

    function renderFAQSection(section) {
        if (!section.faq_items || section.faq_items.length === 0) {
            return '<p>No FAQ items available.</p>';
        }

        return `
            <div class="faq-list">
                ${section.faq_items.map(faq => `
                    <div class="faq-item">
                        <button class="faq-question">${faq.question}</button>
                        <div class="faq-answer">${convertMarkdownToHtml(faq.answer)}</div>
                    </div>
                `).join('')}
            </div>
        `;
    }

    function renderAboutUsSection(section) {
        if (!section.about_us_items || section.about_us_items.length === 0) {
            return '<p>No about us items available.</p>';
        }

        return section.about_us_items.map(item => `
            <div class="about-us-item">
                <h1>${item.name}</h1>
                <div>${convertMarkdownToHtml(item.description)}</div>
            </div>
        `).join('');
    }

    function initializeFAQ() {
        document.querySelectorAll('.faq-question').forEach(btn => {
            btn.addEventListener('click', function() {
                const item = this.parentElement;
                item.classList.toggle('open');
            });
        });
    }

    function initializeNavigation() {
        function setActiveNav() {
            const sections = document.querySelectorAll('section[id]');
            let found = false;
            
            sections.forEach(section => {
                const sectionId = section.id;
                const navLink = document.getElementById('nav-' + sectionId.replace('about-', ''));
                
                if (navLink && window.scrollY + 100 >= section.offsetTop) {
                    document.querySelectorAll('.about-merged-nav a').forEach(a => a.classList.remove('active'));
                    navLink.classList.add('active');
                    found = true;
                }
            });
            
            if (!found) {
                document.querySelectorAll('.about-merged-nav a').forEach(a => a.classList.remove('active'));
            }
        }

        window.addEventListener('scroll', setActiveNav);
        window.addEventListener('DOMContentLoaded', setActiveNav);
    }

    // Load content when the page loads
    window.addEventListener('DOMContentLoaded', loadAboutContent);
    </script>
</body>
</html> 